{"ast":null,"code":"import React,{useEffect,useState}from'react';import{auth,db}from'./firebaseConfig';// Ensure auth is imported correctly\nimport{collection,query,where,getDocs,updateDoc,deleteDoc,doc}from'firebase/firestore';import'./TaskList.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const TaskList=()=>{const[tasks,setTasks]=useState([]);useEffect(()=>{const fetchTasks=async()=>{// Ensure the user is logged in before fetching their tasks\nif(auth.currentUser){const userQuery=query(collection(db,'tasks'),where('userId','==',auth.currentUser.uid));const querySnapshot=await getDocs(userQuery);const fetchedTasks=querySnapshot.docs.map(doc=>({id:doc.id,...doc.data(),completion:doc.data().subtasks?calculateCompletion(doc.data().subtasks):doc.data().status==='Completed'?100:0}));setTasks(fetchedTasks);}};fetchTasks();},[]);const calculateCompletion=subtasks=>{const completedSubtasks=subtasks.filter(subtask=>subtask.completed).length;return completedSubtasks/subtasks.length*100;};const deleteTask=async id=>{await deleteDoc(doc(db,'tasks',id));setTasks(tasks.filter(task=>task.id!==id));};const markAsCompleted=async function(taskId){let subtaskId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;const taskDoc=doc(db,\"tasks\",taskId);let updatedTask;if(subtaskId){updatedTask=tasks.map(task=>{if(task.id===taskId){const updatedSubtasks=task.subtasks.map(subtask=>subtask.id===subtaskId?{...subtask,completed:true}:subtask);return{...task,subtasks:updatedSubtasks,completion:calculateCompletion(updatedSubtasks)};}return task;});}else{updatedTask=tasks.map(task=>task.id===taskId?{...task,status:\"Completed\",completion:100}:task);}await updateDoc(taskDoc,updatedTask.find(task=>task.id===taskId));setTasks(updatedTask);};return/*#__PURE__*/_jsxs(\"div\",{className:\"task-list-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Tasks\"}),/*#__PURE__*/_jsx(\"div\",{className:\"task-list\",children:tasks.map(task=>/*#__PURE__*/_jsxs(\"div\",{className:\"task-item \".concat(task.status==='Completed'?'completed':''),children:[/*#__PURE__*/_jsx(\"h3\",{children:task.title}),/*#__PURE__*/_jsx(\"p\",{children:task.description}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Due: \",task.dueDate]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Priority: \",task.priority]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status: \",task.status]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Tags: \",task.tags.join(', ')]}),task.subtasks&&task.subtasks.map(subtask=>/*#__PURE__*/_jsxs(\"div\",{className:\"subtask \".concat(subtask.completed?'completed':''),children:[/*#__PURE__*/_jsx(\"span\",{children:subtask.title}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>markAsCompleted(task.id,subtask.id),className:\"icon-btn\",children:\"\\u2714\\uFE0F\"})]},subtask.id)),/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar-fill\",style:{width:\"\".concat(task.completion,\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"task-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>markAsCompleted(task.id),className:\"icon-btn\",id:\"complete\",children:\"\\u2714\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteTask(task.id),className:\"icon-btn\",id:\"delete\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]})]},task.id))})]});};export default TaskList;","map":{"version":3,"names":["React","useEffect","useState","auth","db","collection","query","where","getDocs","updateDoc","deleteDoc","doc","jsx","_jsx","jsxs","_jsxs","TaskList","tasks","setTasks","fetchTasks","currentUser","userQuery","uid","querySnapshot","fetchedTasks","docs","map","id","data","completion","subtasks","calculateCompletion","status","completedSubtasks","filter","subtask","completed","length","deleteTask","task","markAsCompleted","taskId","subtaskId","arguments","undefined","taskDoc","updatedTask","updatedSubtasks","find","className","children","concat","title","description","dueDate","priority","tags","join","onClick","style","width"],"sources":["/home/posiden/Documents/GitHub/A.I.D.E.N/aiden_frontend/src/TaskList.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { auth, db } from './firebaseConfig'; // Ensure auth is imported correctly\nimport { collection, query, where, getDocs, updateDoc, deleteDoc, doc } from 'firebase/firestore';\nimport './TaskList.css';\n\nconst TaskList = () => {\n    const [tasks, setTasks] = useState([]);\n\n    useEffect(() => {\n        const fetchTasks = async () => {\n            // Ensure the user is logged in before fetching their tasks\n            if (auth.currentUser) {\n                const userQuery = query(collection(db, 'tasks'), where('userId', '==', auth.currentUser.uid));\n                const querySnapshot = await getDocs(userQuery);\n                const fetchedTasks = querySnapshot.docs.map(doc => ({\n                    id: doc.id,\n                    ...doc.data(),\n                    completion: doc.data().subtasks\n                        ? calculateCompletion(doc.data().subtasks)\n                        : doc.data().status === 'Completed' ? 100 : 0,\n                }));\n                setTasks(fetchedTasks);\n            }\n        };\n\n        fetchTasks();\n    }, []);\n\n    const calculateCompletion = (subtasks) => {\n        const completedSubtasks = subtasks.filter(subtask => subtask.completed).length;\n        return (completedSubtasks / subtasks.length) * 100;\n    };\n\n    const deleteTask = async (id) => {\n        await deleteDoc(doc(db, 'tasks', id));\n        setTasks(tasks.filter(task => task.id !== id));\n    };\n\n    const markAsCompleted = async (taskId, subtaskId = null) => {\n        const taskDoc = doc(db, \"tasks\", taskId);\n        let updatedTask;\n\n        if (subtaskId) {\n            updatedTask = tasks.map(task => {\n                if (task.id === taskId) {\n                    const updatedSubtasks = task.subtasks.map(subtask =>\n                        subtask.id === subtaskId ? { ...subtask, completed: true } : subtask\n                    );\n                    return { ...task, subtasks: updatedSubtasks, completion: calculateCompletion(updatedSubtasks) };\n                }\n                return task;\n            });\n        } else {\n            updatedTask = tasks.map(task =>\n                task.id === taskId ? { ...task, status: \"Completed\", completion: 100 } : task\n            );\n        }\n\n        await updateDoc(taskDoc, updatedTask.find(task => task.id === taskId));\n        setTasks(updatedTask);\n    };\n\n    return (\n        <div className=\"task-list-container\">\n            <h2>Tasks</h2>\n            <div className=\"task-list\">\n                {tasks.map(task => (\n                    <div key={task.id} className={`task-item ${task.status === 'Completed' ? 'completed' : ''}`}>\n                        <h3>{task.title}</h3>\n                        <p>{task.description}</p>\n                        <p>Due: {task.dueDate}</p>\n                        <p>Priority: {task.priority}</p>\n                        <p>Status: {task.status}</p>\n                        <p>Tags: {task.tags.join(', ')}</p>\n                        {task.subtasks && task.subtasks.map(subtask => (\n                            <div key={subtask.id} className={`subtask ${subtask.completed ? 'completed' : ''}`}>\n                                <span>{subtask.title}</span>\n                                <button onClick={() => markAsCompleted(task.id, subtask.id)} className=\"icon-btn\">‚úîÔ∏è</button>\n                            </div>\n                        ))}\n                        <div className=\"progress-bar\">\n                            <div className=\"progress-bar-fill\" style={{ width: `${task.completion}%` }}></div>\n                        </div>\n                        <div className=\"task-actions\">\n                            <button onClick={() => markAsCompleted(task.id)} className=\"icon-btn\" id='complete'>‚úîÔ∏è</button>\n                            <button onClick={() => deleteTask(task.id)} className=\"icon-btn\" id='delete'>üóëÔ∏è</button>\n                        </div>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n};\n\nexport default TaskList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}